<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
body{background:#000;color:#fff;font-family:Arial;padding:20px;}
textarea{width:100%;height:120px;margin-bottom:10px;}
</style>
</head>

<body>
<h2>Admin Panel</h2>
<input type="password" id="key" placeholder="Admin key">
<button onclick="load()">Load Confessions</button>
<div id="out"></div>

<script>
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

function load(){
  const key = document.getElementById("key").value;
  db.collection("confessions").orderBy("time","desc").get().then(snapshot=>{
    let html="";
    snapshot.forEach(doc=>{
      const decrypted = CryptoJS.AES.decrypt(doc.data().data, key)
        .toString(CryptoJS.enc.Utf8);
      html += `<textarea readonly>${decrypted}</textarea>`;
    });
    document.getElementById("out").innerHTML = html;
  });
}
</script>
</body>
</html>
